(function(a){a.QNAStart=new a.QNAStep("Select the ZIP file to import","Select the ZIP file that contains the valid Publican book that you wish to import into PressGang CCMS.",[new a.QNAVariables(null,[new a.QNAVariable(a.InputEnum.SINGLE_FILE,"Publican ZIP File","ZipFile")])],function(g,c,b,d){(new a.QNAZipModel).getEntries(c.ZipFile,function(f){var e=!1;a.angular.forEach(f,function(a,c){if("publican.cfg"===a.filename)return e=!0,!1});e?(c.ZipFileEntries=f,b(null)):d("Error","The ZIP file did not contain a publican.cfg file.")},
function(a){d("Error","Could not process the ZIP file!")})},function(a,c,b,d){b(h)});var h=new a.QNAStep("Select the main XML file","Select the main XML file from the ZIP archive. Publican conventions mean the file should be named after the book title in Book_Info.xml.",[new a.QNAVariables(null,[new a.QNAVariable(a.InputEnum.LISTBOX,null,"MainXMLFile",function(g,c,b,d){var f=function(){var d=[];a.angular.forEach(c.ZipFileEntries,function(a,c){/^en-US\/.*?\.xml$/.test(a.filename)&&d.push(a.filename)});
b(d)},e=!1;a.angular.forEach(c.ZipFileEntries,function(b,g){if(/^en-US\/Book_Info\.xml$/.test(b.filename))return e=!0,(new a.QNAZipModel).getTextFromFile(b,function(b){if(b=/<title>(.*?)<\/title>/.exec(b)){var e="en-US/"+b[1].replace(/ /g,"_")+".xml";a.angular.forEach(c.ZipFileEntries,function(a,b){if(a.filename===e)return d(e),!1})}f()}),!1});e||f()})])],null,function(a,c,b,d){})})(this);
