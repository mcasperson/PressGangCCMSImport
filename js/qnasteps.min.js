(function(a){a.QNAStart=new a.QNAStep(function(a){a("Select the ZIP file to import")},function(a){a("Select the ZIP file that contains the valid Publican book that you wish to import into PressGang CCMS.")},function(b){b([new a.QNAVariables(null,function(b){b([new a.QNAVariable(function(d){d(a.InputEnum.SINGLE_FILE)},function(a){a("Publican ZIP File")},function(a){a("ZipFile")})])})])},function(b,e,d,f){(new a.QNAZipModel).getCachedEntries(f.ZipFile,function(d){var c=!1;a.angular.forEach(d,function(a,
d){if("publican.cfg"===a.filename)return c=!0,!1});c?b(null):e("Error","The ZIP file did not contain a publican.cfg file.")},function(a){e("Error","Could not process the ZIP file!")})},function(a,e,d,f){a(g)});var g=new a.QNAStep(function(a){a("Select the main XML file")},function(a){a("Select the main XML file from the ZIP archive. Publican conventions mean the file should be named after the book title in the Book_Info.xml file. This import tool will attempt to read the Book_Info.xml file to find the book title, and from that select the main XML file. You only need to make a manual selection if the import tool could not find the main XML file, or if you want to override the default selection.")},
function(b){b([new a.QNAVariables(null,function(b){b([new a.QNAVariable(function(d){d(a.InputEnum.LISTBOX)},null,function(a){a("MainXMLFile")},function(d,b,e,c){(new a.QNAZipModel).getCachedEntries(c.ZipFile,function(b){var c=[];a.angular.forEach(b,function(a,d){/^.*?\.xml$/.test(a.filename)&&c.push(a.filename)});d(c)})},function(d,b,e,c){(new a.QNAZipModel).getCachedEntries(c.ZipFile,function(b){a.angular.forEach(b,function(c,e){if(/^en-US\/Book_Info\.xml$/.test(c.filename))return(new a.QNAZipModel).getTextFromFile(c,
function(c){if(c=/<title>(.*?)<\/title>/.exec(c)){var e="en-US/"+c[1].replace(/ /g,"_")+".xml";a.angular.forEach(b,function(a,b){a.filename===e&&d(e)})}}),!1})});d(null)})])})])},null,function(a,e,d,f){})})(this);
