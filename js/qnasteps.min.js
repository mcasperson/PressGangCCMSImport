(function(c){c.QNAStart=new c.QNAStep(function(c,a,b,d){b("Select the ZIP file to import")},function(c,a,b,d){b("Select the ZIP file that contains the valid Publican book that you wish to import into PressGang CCMS.")},function(e,a,b,d){b([new c.QNAVariables(null,function(b,d,a,e){a([new c.QNAVariable(function(b,a,f,d){f(c.InputEnum.SINGLE_FILE)},function(c,b,f,a){f("Publican ZIP File")},function(c,b,f,a){f("ZipFile")})])})])},function(e,a,b,d){(new c.QNAZipModel).getCachedEntries(a.ZipFile,function(a){var e=
!1;c.angular.forEach(a,function(c,b){if("publican.cfg"===c.filename)return e=!0,!1});e?b(null):d("Error","The ZIP file did not contain a publican.cfg file.")},function(c){d("Error","Could not process the ZIP file!")})},function(c,a,b,d){b(g)});var g=new c.QNAStep(function(c,a,b,d){b("Select the main XML file")},function(c,a,b,d){b("Select the main XML file from the ZIP archive. Publican conventions mean the file should be named after the book title in the Book_Info.xml file. This import tool will attempt to read the Book_Info.xml file to find the book title, and from that select the main XML file. You only need to make a manual selection if the import tool could not find the main XML file, or if you want to override the default selection.")},
function(e,a,b,d){b([new c.QNAVariables(null,function(b,a,d,e){d([new c.QNAVariable(function(b,a,d,e){d(c.InputEnum.LISTBOX)},null,function(c,b,a,d){a("MainXMLFile")},function(b,a,d,e){(new c.QNAZipModel).getCachedEntries(a.ZipFile,function(b){var a=[];c.angular.forEach(b,function(c,b){/^.*?\.xml$/.test(c.filename)&&a.push(c.filename)});d(a)})},function(b,a,d,e){(new c.QNAZipModel).getCachedEntries(a.ZipFile,function(b){c.angular.forEach(b,function(a,e){if(/^en-US\/Book_Info\.xml$/.test(a.filename))return(new c.QNAZipModel).getTextFromFile(a,
function(a){if(a=/<title>(.*?)<\/title>/.exec(a)){var e="en-US/"+a[1].replace(/ /g,"_")+".xml";c.angular.forEach(b,function(a,b){a.filename===e&&d(e)})}}),!1})});d(null)})])})])},null,function(c,a,b,d){})})(this);
